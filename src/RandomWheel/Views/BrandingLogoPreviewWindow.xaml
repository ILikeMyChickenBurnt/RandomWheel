<Window x:Class="RandomWheel.Views.BrandingLogoPreviewWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Adjust Branding Logo" 
        Height="500" Width="550"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="{StaticResource BackgroundBrush}">
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Instructions -->
        <TextBlock Grid.Row="0" 
                   Text="Drag the image to position it within the circle. Use the slider to zoom." 
                   TextWrapping="Wrap"
                   Foreground="{StaticResource TextSecondaryBrush}"
                   Margin="0,0,0,16" />

        <!-- Preview Area -->
        <Border Grid.Row="1" 
                Background="{StaticResource SurfaceBrush}" 
                BorderBrush="{StaticResource BorderBrush}" 
                BorderThickness="1"
                CornerRadius="8"
                ClipToBounds="True">
            <Grid>
                <!-- Checkerboard pattern for transparency -->
                <Rectangle>
                    <Rectangle.Fill>
                        <DrawingBrush TileMode="Tile" Viewport="0,0,20,20" ViewportUnits="Absolute">
                            <DrawingBrush.Drawing>
                                <DrawingGroup>
                                    <GeometryDrawing Brush="#EEEEEE">
                                        <GeometryDrawing.Geometry>
                                            <RectangleGeometry Rect="0,0,20,20" />
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>
                                    <GeometryDrawing Brush="#CCCCCC">
                                        <GeometryDrawing.Geometry>
                                            <GeometryGroup>
                                                <RectangleGeometry Rect="0,0,10,10" />
                                                <RectangleGeometry Rect="10,10,10,10" />
                                            </GeometryGroup>
                                        </GeometryDrawing.Geometry>
                                    </GeometryDrawing>
                                </DrawingGroup>
                            </DrawingBrush.Drawing>
                        </DrawingBrush>
                    </Rectangle.Fill>
                </Rectangle>

                <!-- Centered container for the circular preview -->
                <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                    <!-- White background circle -->
                    <Ellipse x:Name="PreviewCircleBackground" 
                             Width="300" Height="300" 
                             Fill="White"
                             Stroke="{StaticResource BorderBrush}"
                             StrokeThickness="2" />
                    
                    <!-- Draggable image area -->
                    <Canvas x:Name="ImageCanvas" 
                            Width="300" Height="300"
                            ClipToBounds="True"
                            MouseLeftButtonDown="ImageCanvas_MouseLeftButtonDown"
                            MouseLeftButtonUp="ImageCanvas_MouseLeftButtonUp"
                            MouseMove="ImageCanvas_MouseMove"
                            Cursor="Hand">
                        <Canvas.Clip>
                            <EllipseGeometry Center="150,150" RadiusX="150" RadiusY="150" />
                        </Canvas.Clip>
                        
                        <Image x:Name="PreviewImage" 
                               Stretch="Uniform"
                               RenderTransformOrigin="0.5,0.5">
                            <Image.RenderTransform>
                                <TransformGroup>
                                    <ScaleTransform x:Name="ImageScale" ScaleX="1" ScaleY="1" />
                                    <TranslateTransform x:Name="ImageTranslate" X="0" Y="0" />
                                </TransformGroup>
                            </Image.RenderTransform>
                        </Image>
                    </Canvas>

                    <!-- Circle outline overlay -->
                    <Ellipse Width="300" Height="300" 
                             Stroke="#2196F3"
                             StrokeThickness="3"
                             StrokeDashArray="5,3"
                             Fill="Transparent"
                             IsHitTestVisible="False" />
                </Grid>
            </Grid>
        </Border>

        <!-- Zoom Slider -->
        <Grid Grid.Row="2" Margin="0,16,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            
            <TextBlock Grid.Column="0" 
                       Text="Zoom:" 
                       VerticalAlignment="Center"
                       Foreground="{StaticResource TextPrimaryBrush}"
                       Margin="0,0,12,0" />
            
            <Slider x:Name="ZoomSlider" 
                    Grid.Column="1"
                    Minimum="0.5" 
                    Maximum="3.0" 
                    Value="1.0"
                    TickFrequency="0.1"
                    IsSnapToTickEnabled="False"
                    ValueChanged="ZoomSlider_ValueChanged"
                    VerticalAlignment="Center" />
            
            <TextBlock x:Name="ZoomLabel" 
                       Grid.Column="2" 
                       Text="100%"
                       Width="50"
                       TextAlignment="Right"
                       VerticalAlignment="Center"
                       Foreground="{StaticResource TextSecondaryBrush}"
                       Margin="12,0,0,0" />
        </Grid>

        <!-- Buttons -->
        <StackPanel Grid.Row="3" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right"
                    Margin="0,16,0,0">
            <Button x:Name="ResetButton"
                    Content="Reset"
                    Style="{StaticResource ModernButtonStyle}"
                    Width="80"
                    Margin="0,0,8,0"
                    Click="ResetButton_Click" />
            <Button x:Name="CancelButton"
                    Content="Cancel"
                    Style="{StaticResource ModernButtonStyle}"
                    Width="80"
                    Margin="0,0,8,0"
                    Click="CancelButton_Click" />
            <Button x:Name="ApplyButton"
                    Content="Apply"
                    Style="{StaticResource AccentButtonStyle}"
                    Width="100"
                    Click="ApplyButton_Click" />
        </StackPanel>
    </Grid>
</Window>
